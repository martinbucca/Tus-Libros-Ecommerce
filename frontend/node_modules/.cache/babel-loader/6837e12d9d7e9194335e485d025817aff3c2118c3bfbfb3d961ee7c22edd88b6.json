{"ast":null,"code":"import { ServerErrorResponse } from \"../responses/generalResponses/ServerErrorResponse\";\nimport { UnexpectedErrorResponse } from \"../responses/generalResponses/UnexpectedErrorResponse\";\nimport { AuthenticationErrorResponse } from \"../responses/generalResponses/AuthenticationErrorResponse\";\nexport default class ApiClient {\n  constructor(requester, onServerErrorDo = () => {}, onAuthorizationErrorDo = () => {}, onExceptionDo = exception => {\n    throw exception;\n  }) {\n    this._requester = requester;\n    this._defaultHandleError = () => {};\n    this._onServerErrorDo = onServerErrorDo;\n    this._onExceptionDo = onExceptionDo;\n    this._onAuthorizationErrorDo = onAuthorizationErrorDo;\n    this._handleResponse = this._handleResponse.bind(this);\n    this._handleException = this._handleException.bind(this);\n  }\n  _handleException(exception) {\n    return this._onExceptionDo(exception);\n  }\n  handleError(onHandlerErrorDo) {\n    this._defaultHandleError = onHandlerErrorDo;\n  }\n  _handleResponse(response, handleError) {\n    if (response.hasError()) {\n      if (handleError === undefined) {\n        this._defaultHandleError(response);\n      } else {\n        handleError(response);\n      }\n      return response;\n    }\n    if (response instanceof ServerErrorResponse || response instanceof UnexpectedErrorResponse) {\n      return this._onServerErrorDo(response);\n    }\n    if (response instanceof AuthenticationErrorResponse) {\n      return this._onAuthorizationErrorDo(response);\n    }\n    return response;\n  }\n  _callEndpoint(endpoint, values) {\n    let result = this._call(endpoint, values);\n    return result.then(response => {\n      this._handleResponse(response);\n      return result;\n    }).catch(exception => {\n      return this._handleException(exception);\n    });\n  }\n  _call(endpoint, values) {\n    return this._requester.call({\n      endpoint: endpoint,\n      data: endpoint.adaptValues(values)\n    });\n  }\n}","map":{"version":3,"names":["ServerErrorResponse","UnexpectedErrorResponse","AuthenticationErrorResponse","ApiClient","constructor","requester","onServerErrorDo","onAuthorizationErrorDo","onExceptionDo","exception","_requester","_defaultHandleError","_onServerErrorDo","_onExceptionDo","_onAuthorizationErrorDo","_handleResponse","bind","_handleException","handleError","onHandlerErrorDo","response","hasError","undefined","_callEndpoint","endpoint","values","result","_call","then","catch","call","data","adaptValues"],"sources":["/Users/martin/FIUBA/Ingenieria de Software I/tus-libros/frontend/src/lib/communication/src/client/ApiClient.js"],"sourcesContent":["import {ServerErrorResponse} from \"../responses/generalResponses/ServerErrorResponse\";\nimport {UnexpectedErrorResponse} from \"../responses/generalResponses/UnexpectedErrorResponse\";\nimport {AuthenticationErrorResponse} from \"../responses/generalResponses/AuthenticationErrorResponse\";\n\n\nexport default class ApiClient {\n    constructor(requester, onServerErrorDo = () => {\n    }, onAuthorizationErrorDo = () => {\n    }, onExceptionDo = (exception) => {\n        throw exception;\n    },) {\n        this._requester = requester;\n        this._defaultHandleError = () => {\n        };\n        this._onServerErrorDo = onServerErrorDo;\n        this._onExceptionDo = onExceptionDo;\n        this._onAuthorizationErrorDo = onAuthorizationErrorDo;\n        this._handleResponse = this._handleResponse.bind(this);\n        this._handleException = this._handleException.bind(this);\n    }\n\n    _handleException(exception) {\n        return this._onExceptionDo(exception)\n    }\n\n    handleError(onHandlerErrorDo) {\n        this._defaultHandleError = onHandlerErrorDo;\n    }\n\n    _handleResponse(response, handleError) {\n        if (response.hasError()) {\n            if (handleError === undefined) {\n                this._defaultHandleError(response);\n            } else {\n                handleError(response)\n            }\n\n            return response\n        }\n\n        if (response instanceof ServerErrorResponse || response instanceof UnexpectedErrorResponse) {\n            return this._onServerErrorDo(response);\n        }\n\n        if (response instanceof AuthenticationErrorResponse) {\n            return this._onAuthorizationErrorDo(response);\n        }\n        return response;\n    }\n\n    _callEndpoint(endpoint, values) {\n        let result = this._call(endpoint, values);\n        return result.then((response) => {\n            this._handleResponse(response)\n            return result\n        }).catch((exception) => {\n            return this._handleException(exception)\n        });\n    }\n\n    _call(endpoint, values) {\n        return this._requester.call({\n            endpoint: endpoint, data: endpoint.adaptValues(values)\n        });\n    }\n}\n"],"mappings":"AAAA,SAAQA,mBAAmB,QAAO,mDAAmD;AACrF,SAAQC,uBAAuB,QAAO,uDAAuD;AAC7F,SAAQC,2BAA2B,QAAO,2DAA2D;AAGrG,eAAe,MAAMC,SAAS,CAAC;EAC3BC,WAAWA,CAACC,SAAS,EAAEC,eAAe,GAAGA,CAAA,KAAM,CAC/C,CAAC,EAAEC,sBAAsB,GAAGA,CAAA,KAAM,CAClC,CAAC,EAAEC,aAAa,GAAIC,SAAS,IAAK;IAC9B,MAAMA,SAAS;EACnB,CAAC,EAAG;IACA,IAAI,CAACC,UAAU,GAAGL,SAAS;IAC3B,IAAI,CAACM,mBAAmB,GAAG,MAAM,CACjC,CAAC;IACD,IAAI,CAACC,gBAAgB,GAAGN,eAAe;IACvC,IAAI,CAACO,cAAc,GAAGL,aAAa;IACnC,IAAI,CAACM,uBAAuB,GAAGP,sBAAsB;IACrD,IAAI,CAACQ,eAAe,GAAG,IAAI,CAACA,eAAe,CAACC,IAAI,CAAC,IAAI,CAAC;IACtD,IAAI,CAACC,gBAAgB,GAAG,IAAI,CAACA,gBAAgB,CAACD,IAAI,CAAC,IAAI,CAAC;EAC5D;EAEAC,gBAAgBA,CAACR,SAAS,EAAE;IACxB,OAAO,IAAI,CAACI,cAAc,CAACJ,SAAS,CAAC;EACzC;EAEAS,WAAWA,CAACC,gBAAgB,EAAE;IAC1B,IAAI,CAACR,mBAAmB,GAAGQ,gBAAgB;EAC/C;EAEAJ,eAAeA,CAACK,QAAQ,EAAEF,WAAW,EAAE;IACnC,IAAIE,QAAQ,CAACC,QAAQ,CAAC,CAAC,EAAE;MACrB,IAAIH,WAAW,KAAKI,SAAS,EAAE;QAC3B,IAAI,CAACX,mBAAmB,CAACS,QAAQ,CAAC;MACtC,CAAC,MAAM;QACHF,WAAW,CAACE,QAAQ,CAAC;MACzB;MAEA,OAAOA,QAAQ;IACnB;IAEA,IAAIA,QAAQ,YAAYpB,mBAAmB,IAAIoB,QAAQ,YAAYnB,uBAAuB,EAAE;MACxF,OAAO,IAAI,CAACW,gBAAgB,CAACQ,QAAQ,CAAC;IAC1C;IAEA,IAAIA,QAAQ,YAAYlB,2BAA2B,EAAE;MACjD,OAAO,IAAI,CAACY,uBAAuB,CAACM,QAAQ,CAAC;IACjD;IACA,OAAOA,QAAQ;EACnB;EAEAG,aAAaA,CAACC,QAAQ,EAAEC,MAAM,EAAE;IAC5B,IAAIC,MAAM,GAAG,IAAI,CAACC,KAAK,CAACH,QAAQ,EAAEC,MAAM,CAAC;IACzC,OAAOC,MAAM,CAACE,IAAI,CAAER,QAAQ,IAAK;MAC7B,IAAI,CAACL,eAAe,CAACK,QAAQ,CAAC;MAC9B,OAAOM,MAAM;IACjB,CAAC,CAAC,CAACG,KAAK,CAAEpB,SAAS,IAAK;MACpB,OAAO,IAAI,CAACQ,gBAAgB,CAACR,SAAS,CAAC;IAC3C,CAAC,CAAC;EACN;EAEAkB,KAAKA,CAACH,QAAQ,EAAEC,MAAM,EAAE;IACpB,OAAO,IAAI,CAACf,UAAU,CAACoB,IAAI,CAAC;MACxBN,QAAQ,EAAEA,QAAQ;MAAEO,IAAI,EAAEP,QAAQ,CAACQ,WAAW,CAACP,MAAM;IACzD,CAAC,CAAC;EACN;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}